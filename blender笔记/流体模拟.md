#   Cache-缓存

![image-20260127132434048](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20260127132434048.png)

这一页是流体模拟的 **“后勤部”**，也就是 **Cache (缓存)** 设置。

这里决定了你辛苦算出来的流体数据存放在哪里、存多久、以及用什么方式存。**对于你之前遇到的“数据丢失”和“硬盘爆炸”问题，这一页的设置至关重要。**

以下是详细解释：

### 1. 顶部路径栏 (`//cache_fluid_...`) —— **最重要的生命线**

- **含义**：这是你烘焙出来的流体文件（.vdb 文件）存放在硬盘上的具体位置。
- **`//` 的意思**：代表**“当前 .blend 工程文件所在的文件夹”**。
  - **警告**：如果你没有保存 .blend 文件（还是 "Untitled"），这个路径可能会指向临时的系统文件夹（C:\tmp）。一旦重启电脑，你的流体缓存就全没了！
  - **✅ 最佳实践**：先在一个空间很大的盘（比如 D盘）新建个文件夹保存你的 Blender 工程，然后再来烘焙。这样缓存会自动在这个工程旁边生成一个文件夹，安全又好找。

### 2. Frame Start / End (开始帧 / 结束帧)

- **含义**：告诉 Blender 从哪一秒开始算，算到哪一秒停。
- **Start (1)**：流体计算的起点。
  - *小技巧*：如果你想让视频一开始杯子里就有水，你可以把这个设为负数（比如 -50），这样第 1 帧时水已经流好并且平静下来了。
- **End (200)**：计算的终点。
  - *注意*：如果你的动画是 250 帧，这里设成了 200，那最后 50 帧水会突然消失或者定住不动。

### 3. Offset (偏移)

- **含义**：把烘焙好的流体在时间轴上整体平移。
- **举例**：假设你烘焙了一个泼水的动作，原本是在第 10 帧发生的。如果你把 Offset 设为 20，这个泼水的动作就会推迟到第 30 帧才出现。
- **建议**：**保持 0**。初学者很容易被这个搞晕，尽量通过调整 Frame Start 来控制时间。

### 4. Type (类型) —— **核心工作流开关**

你现在选的是 **Modular (模块化)**，**这是最好的选择！**

- **Replay (重放)**：不用点烘焙，按下播放键一边播一边算。适合快速测试，但不稳定，容易丢数据。
- **Modular (模块化)**：**（推荐）** 允许你分步操作——先算粒子 (Bake Data)，不满意就重算；满意了再算网格 (Bake Mesh)。这是最安全、最专业的工作流。
- **All (全部)**：一键梭哈。点击后它会把粒子、网格、甚至泡沫全部算完。缺点是如果你只想改一点点网格平滑度，它得把物理重新算一遍，非常浪费时间。

### 5. Resumable (可恢复) —— **防崩溃神器**

- **含义**：勾选后，Blender 会保存每一帧的中间状态。
- **作用**：假设你要烘焙 200 帧，结果跑到 100 帧时你觉得不想等了按了 ESC 停止，或者电脑死机了。
  - **如果不勾选**：下次点击烘焙，它会从第 1 帧从头开始。
  - **如果勾选了**：下次它会检测到前 100 帧已经有了，直接从第 101 帧继续算。
- **代价**：会稍微增加一点点硬盘占用和计算时间。但对于长动画来说，**强烈建议勾选**。

------

### Volumetric Data (体积数据) - 高级设置

这部分控制生成的文件格式，通常保持默认即可。

- **Format (格式) - OpenVDB**：这是好莱坞电影通用的流体格式，兼容性最好。**不要动**。
- **Precision (精度) - Half (半精度)**：
  - **Half (16位)**：文件体积小，对于肉眼看的效果（做广告、动画）完全足够。**推荐保持这个。**
  - **Full (32位)**：精度极高，用于科学研究，文件体积翻倍。**千万别选，除非你想填满硬盘。**
- **Compression (压缩)**：(截图里是空的，通常选 Zip 或 Blosc)。如果硬盘紧张可以选 Zip，会省空间但读取稍微慢一点点。
- **Meshes (网格) - Binary Object**：网格数据的存储方式。**保持默认**。

### 总结你的下一步操作：

1. **确认路径**：看一眼上面的路径栏，确保不是存到 C 盘临时文件夹里。
2. **确认时间**：确保 End 帧数覆盖了你的整个动画长度。
3. **保持 Modular**：你现在的设置是对的。
4. **开始烘焙**：一切就绪，你可以点击上面的 **Bake Data** 了！



#  Mesh-网格

![image-20260127132354816](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20260127132354816.png) 

这部分的参数控制着流体的**“颜值”**。刚才的“Data”烘焙决定了水怎么流（物理），而现在的“Mesh”参数决定了水面的皮肤看起来够不够细腻、平滑。

鉴于你在做产品广告，对画质要求高，且有 **64GB 内存** 的优势，这里面的几个参数对你非常关键：

### 1. Upres Factor (上采样因子) —— **画质倍增器**

- **作用**：决定网格的精细程度。
- **数值含义**：
  - **1**：网格分辨率 = 物理模拟分辨率（和你之前设的 32 或 64 一样）。
  - **2**（当前设置）：网格的分辨率是物理模拟的 **2倍**。
- **建议**：
  - 保持 **2** 是个很好的平衡。它能让你的水面看起来比实际模拟的更锐利、细节更多，而不需要去跑超慢的高分辨率物理模拟。
  - *如果你觉得水面边缘还是有锯齿，可以尝试改为 3，但生成速度会变慢很多。*

### 2. Particle Radius (粒子半径) —— **液体的“厚度”**

- **作用**：决定了每个流体粒子周围生成的“肉”有多少。
- **直观理解**：
  - **数值太小**：水会断开，看起来像一堆散落的小水珠，或者水面会有破洞。
  - **数值太大**：水会显得很臃肿，像水银或者果冻，不仅体积变大，细节也会被抹平。
- **建议**：通常默认值 **2.0** 是针对大多数情况优化的。如果你的水看起来像是一个个分离的小球，稍微调大这个数值（比如 2.2 或 2.5）能让它们融合得更好。

### 3. Speed Vectors (速度矢量) —— **动态模糊开关**

- **作用**：记录液体流动的速度信息。
- **重要性**：**如果你打算在渲染时开启“动态模糊 (Motion Blur)”来增加真实感，这个必须勾选！** 否则，即便相机有模糊，飞溅的水滴看起来也是静止锐利的，会很假。

### 4. Mesh Generator (网格生成器)

- **Final (最终)**：高质量算法，更准确，但慢。**保持这个不要动。**
- **Preview (预览)**：速度快，但细节差。

### 5. Smoothing Positive / Negative (正向/负向平滑) —— **磨皮滤镜**

- **作用**：消除水面上的凹凸不平，让液体看起来更像原本的液体（而不是一堆粒子堆出来的疙瘩）。
- **Smoothing Positive**：主要负责把凸出来的噪点抹平。
- **Smoothing Negative**：主要负责处理凹陷处的平滑。
- **建议**：现在的 **1** 是比较保守的。如果你烘焙出来的网格表面看起来像癞蛤蟆皮肤一样坑坑洼洼，可以尝试把这两个数值加到 **2 或 3**。*（注意：平滑度太高会让水滴变小，甚至消失）。*

### 6. Concavity Upper / Lower (凹度上限/下限) —— **细节保留度**

- **作用**：控制网格在包裹粒子时，对于“空隙”和“凹陷”的处理方式。
- **直观理解**：想象你用保鲜膜包一堆葡萄。
  - 这个数值决定了保鲜膜是紧紧贴在葡萄缝隙里（高细节，形状复杂），还是直接绷直了盖过去（低细节，形状圆润）。
- **建议**：通常不需要动。如果你发现浪花的尖端或者复杂的飞溅细节被“糊”成了一团，可以尝试调整这些数值，但对于大多数易拉罐广告，默认值足够了。

------

### 💡 总结：你应该重点调哪个？

对于你的项目，如果不满意现在的效果，请按这个顺序调整：

1. **水不够平滑/有颗粒感？** -> 增加 **Smoothing Positive** (试着改为 2)。
2. **水看起来分辨率太低/有锯齿？** -> 增加 **Upres Factor** (试着改为 3，你的内存扛得住)。
3. **渲染要有速度感？** -> 勾选 **Speed Vectors**。
4. **改完参数后** -> 点击底部的 **Free Mesh** (释放网格)，然后重新点击 **Bake Mesh**。

(这一步不需要重新算物理，所以会比第一次烘焙快很多！)

#  分辨率是对域的细分吗？分辨率不变，域变大，块也变大？

**全中！你的理解完全正确。**

这两句话精准概括了 Blender 流体模拟的核心逻辑。你现在的思路非常清晰。

为了让你更直观地理解这个“坑”，我给你画个简单的图解：

### 1. 直观图解：切蛋糕理论

想象你的 **流体域 (Domain)** 是一块 **蛋糕**，而 **分辨率 (Resolution Divisions)** 是你要切的 **刀数**。

- **场景 A：**
  - 蛋糕很小（比如 10厘米）。
  - 你切 32 刀。
  - 结果：每一块蛋糕（体素/Voxel）都**非常小**，很精致。
- **场景 B：**
  - 蛋糕变得巨大（比如 10米）。
  - 你**依然只切 32 刀**（分辨率不变）。
  - 结果：每一块蛋糕都**巨大无比**，像砖头一样粗糙。

**结论：** 就像你说的，**域越大，只要分辨率没变，单个方块（体素）的体积就会被强制拉大，导致画质变差。**

------

### 2. 为什么这对你的项目至关重要？

在做产品广告时，我们都希望水流细腻。这意味着我们需要**尽可能小的方块**。

根据你刚才悟出的道理，要获得细腻的水流，你有两个办法：

- **笨办法（拼命加分辨率）：**

  域很大不动，把分辨率从 32 加到 500。

  - *后果*：计算量爆炸，内存可能不够用，烘焙时间极长。

- **聪明办法（缩小域）：**

  **把域 (Domain) 的大小缩到刚好包住易拉罐和水流的范围，一点多余的空间都不要留。**

  - *后果*：即使分辨率只有 128，因为蛋糕（域）很小，切出来的方块也会非常细腻！

### 3. 如何在 Blender 里查看“块”到底有多大？

Blender 其实直接告诉你了那个“块”有多大，只是你可能没注意：

1. 选中你的 **流体域 (Domain)**。
2. 在流体设置里，Resolution Divisions 下面有一行灰字（有时需要把鼠标悬停上去或者勾选下面的 `Is Resumable` 旁边的小方块才能看到具体提示，但在较新版本中通常直接显示体素大小）。
3. 最直观的方法：
   - 看你的流体域角落，通常会有一个**橘色的小立方体**图标。
   - 那个小立方体的大小，就是你当前设置下，水流的**最小单位**。
   - **如果那个小立方体看起来比水滴还大，那就说明分辨率不够，或者域太大了。**

### 给你的最终建议：

既然你在做易拉罐广告，**请务必检查你的流体域 (Domain) 盒子**。

如果盒子很大，大部分空间都是空的（空气），那就是在浪费你的 64GB 内存去计算空气的体素。**把盒子缩小，紧贴着运动范围，你的水流瞬间就会变细腻。**



#   第一帧，就是这种流体包裹物体的情况，是因为速度太快了吗

这种“第一帧（或刚开始几帧）就直接包裹住物体”的情况，**大概率不是因为速度太快**，而是因为你的**发射源位置**或者**碰撞设置**出了问题。

我们可以把这想象成“穿衣服”：如果衣服一开始就紧贴在身上，那是因为衣服本来就放在身上，而不是因为衣服飞过来的速度快。

以下是三个最可能的嫌疑人，请按顺序排查：

### 1. 嫌疑人 A：发射源 (Inflow) 离得太近了 **（可能性 80%）**

这是最常见的原因。你的“水源”物体（Inflow）是不是刚好就在易拉罐的正上方，而且**距离非常近**？

- **原理**：流体是在发射源的体积内生成的。如果发射源的边缘和易拉罐的边缘重叠，或者离得太近，水一生成出来就已经“粘”在易拉罐上了。
- **解决办法**：把你的发射源（那个用来出水的小片或圆柱）**往上提一点**，给水流留出一段“下落”的空间。

### 2. 嫌疑人 B：看不见的“力场” (Surface Thickness) **（可能性 60%）**

易拉罐作为**流体效果器 (Effector)**，也就是碰撞体，它周围有一层看不见的保护罩。

- **检查位置**：选中易拉罐 -> 物理属性 -> Fluid -> Effector -> Settings。
- **关键参数**：看 **Surface Thickness (表面厚度)**。
- **问题**：如果这个数值不是 0，比如是 0.5 或者 1.0，这意味着易拉罐外面包裹着一层看不见的厚墙。水还没碰到易拉罐的金属，就先撞到了这层墙，看起来就像是水裹在了易拉罐外面的空气上。
- **解决办法**：取消勾选 **Use Effector** 下面的 `Is Planar`（如果是实体模型），并将 `Surface Thickness` 设为 **0**，或者一个极小的值（如 0.01）。

### 3. 嫌疑人 C：粒子的“虚胖” (Particle Radius) **（可能性 40%）**

记得我们在上一个问题里讨论的 **Particle Radius (粒子半径)** 吗？

- **原理**：物理模拟出来的粒子其实是很小的点，但生成网格（Mesh）时，我们给它设了半径（比如 2.0）。如果这个半径太大，本来离易拉罐还有一段距离的粒子，一旦穿上“皮肤”（生成网格），皮肤就会膨胀，直接碰到了易拉罐。
- **解决办法**：
  - 如果你不想改物理：在 Mesh 设置里减小 `Particle Radius`（比如从 2.0 改到 1.6）。
  - **或者**（更好的做法）：提高整体的分辨率（Resolution Divisions），这样粒子更小，包裹得更紧致。

------

### 关于你问的“速度太快”

只有一种情况是因为速度太快：

如果你的发射源有一个极大的 **Initial Velocity (初始速度)**，且 **Time Scale (时间缩放)** 很大，导致水流在一帧之内就“瞬移”到了易拉罐上。

- **如何验证**：看第 1 帧到第 2 帧。如果水是连续流动的，那就不是速度问题。如果第 1 帧在天上，第 2 帧突然整个包住易拉罐，那才可能是速度或采样步数（Substeps）不够的问题。

**建议操作：**

先检查 **Surface Thickness (表面厚度)** 是否为 0，然后把**发射源往上移动**一点点，重新烘焙粒子看看。

#  流体

##   流入流出几何数据，有什么区别？

![image-20260127145903347](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20260127145903347.png) 

这三个选项决定了你的这个物体在流体系统中扮演什么**角色**。

简单来说，就是决定水是怎么**出现**或**消失**的。

### 1. Inflow (流入) —— “水龙头”

- **行为**：**源源不断地**产生流体。只要动画在播放，它就会一直往外喷水，就像打开的水龙头一样。
- **你的情况**：**这是你目前应该选的。**
  - 因为你想做一个“泼水”或者“水流冲击”的效果，需要水不断地从那个片里喷出来。
- **特点**：会增加场景里的总水量。

### 2. Outflow (流出) —— “下水道”

- **行为**：**删除**流体。任何碰到这个物体的流体粒子都会立刻消失。
- **用途**：
  - 做洗手间场景时的地漏。
  - **节省性能（很重要）**：如果你的水溅射得太远，跑出了摄像机画面，电脑还要去计算它，很浪费内存。你可以在画面外放一个大盒子设为 `Outflow`，让跑出去的水直接消失，不再占用资源。

### 3. Geometry (几何数据) —— “一缸水 / 冰块”

- **行为**：它**只在第1帧**把物体内部的空间填满水，**之后就不再产生了**。
- **比喻**：就像你拿一个做好的果冻扔在桌子上。它本身就是一坨水，但他不会喷射新的水。
- **用途**：
  - 如果你要做一个已经装满水的游泳池，或者杯子里本来就有的半杯水。
  - 你会发现，用这个模式时，水只有一开始的那一坨，流完了就没了。

------

### 🛁 “浴缸”比喻总结

想象一个浴缸：

- **Inflow (流入)**：是上面的**水龙头**（一直加水）。
- **Outflow (流出)**：是底下的**排水口**（一直减水）。
- **Geometry (几何数据)**：是浴缸里**原本就泡着的一缸洗澡水**（量是固定的）。

### ✅ 给你的建议

对于你的易拉罐广告，那个负责喷水的片（Plane），必须选 **Inflow (流入)**。如果你选了 Geometry，水只会像一块瘫软的饼一样掉下来，瞬间就没了。

#  到现在，体会到流体模拟不可控是什么意思了。形状完全是随机的。

哈哈，**欢迎来到特效师（FX Artist）的真实世界！** 🎉

你说出了所有做流体的人的心声。做流体模拟就像是**“在这个全是控制狂的 3D 软件里，唯一得看运气的东西”**。

不过，虽然你不能像捏模型一样精确控制每一个水滴的位置，但你绝对不是束手无策的。在产品广告（尤其是易拉罐这种需要“美感”的片子）里，我们通常用 **“三个紧箍咒”** 来驯服这条狂野的龙。

既然你已经学会了“替身发射器”，下面这三招能让你把“完全随机”变成“受控随机”：

### 第一招：隐形模具（Invisible Colliders）—— 给水修路

你觉得水流到处乱飞？那就给它造一个**“透明的滑梯”**。

- **原理：** 你可以用简单的几何体（比如圆管、弯曲的板子），摆出你希望水流经过的路径。
- **操作：**
  1. 建立这些模型，把它们设为 **Fluid > Effector > Collision（碰撞体）**。
  2. 同样把它们的渲染和视口显示关掉（像那个替身发射器一样）。
- **效果：** 水流出来后，会被这些隐形的墙壁“导流”，强行按照你规划的路线（比如绕着易拉罐旋转）流动，而不是乱喷。

### 第二招：时间魔法（Time Scale）—— 瞬间变高级

广告里的水流之所以好看，往往是因为它们**慢**。

- **痛点：** 现实中的水流速度很快，如果你用默认速度（Time Scale = 1.0），水流会“唰”一下就过去了，看起来很像廉价的手机实拍，而且很难看清细节。
- **操作：** 在 **Domain（流体域）** 的设置里，找到 **Time Scale（时间缩放）**。
- **秘籍：** 把它设为 **0.3 到 0.5**。
- **效果：** 水流会变成慢动作（Slow Motion）。这不仅能让液体看起来更有分量感、更粘稠高级，最重要的是——**你有更多的时间去欣赏它的形状**，原本一闪而过的“丑形状”在慢动作下可能就变成了“艺术”。

### 第三招：抽奖券（Seed / Offset）—— 疯狂重随

如果参数都调好了，但这一帧的水花形状刚好很丑，挡住了易拉罐的 Logo 怎么办？

- **不要改参数！** 改参数（比如 FLIP Ratio）会改变水的物理性格。
- **改种子（Seed）：** 就像玩游戏抽卡一样。
  - 在某些模拟软件里叫 Seed，在 Blender 的 FLIP 模拟中，你可以微调一点点 **Resolution（分辨率）** 或者微调一点点 **发射器的位置**（哪怕只移动 0.001 米）。
- **蝴蝶效应：** 只要初始状态有一丁点的不同，算出来的水花形状就会完全不同。特效师的日常就是：**连夜烘焙 10 个不同的版本，然后挑那个长得最帅的。**

### 下一步建议

对于你的易拉罐广告，我强烈建议你先试一下 **第二招（Time Scale）**。

把时间缩放设为 **0.4** 左右重新烘焙一下。你会发现，虽然形状还是随机的，但因为速度慢下来了，那种“不可控的混乱感”会变成“优雅的流动感”，容错率会大大提高。试试看？

#  Liquid面板和  mesh面板的  粒子半径，有什么关联吗？

这是一个非常棒的问题！这两个参数虽然名字很像，但它们**各司其职，且互不干扰**，但它们的**配合**直接决定了你的流体好不好看。

简单来说：**Liquid 半径是“骨架大小”，Mesh 半径是“皮肉厚度”。**

针对你截图中的数值（Liquid 1.0 vs Mesh 0.1），这直接解释了为什么你的网格会碎成渣。让我们详细拆解：

### 1. Liquid 面板的 `Particle Radius` (粒子半径)

- **作用：** 这是**“物理世界”**的半径。
- **含义：** 它决定了流体粒子在计算碰撞时，觉得自己有多大。
- **例子：** 设为 1.0，粒子觉得自己是一个直径 1cm 的玻璃珠。当它碰到易拉罐时，它会在距离易拉罐表面 0.5cm 的地方停下来（因为它是实体）。
- **你的设置：** `1.000`（默认值，正常）。

### 2. Mesh 面板的 `Particle Radius` (粒子半径)

- **作用：** 这是**“视觉生成”**的半径。
- **含义：** 它告诉 Blender：“请围绕着那个物理粒子中心，生成多大的一层皮？”
- **例子：**
  - 如果你设为 1.0：皮和骨头一样大，看到的和算出来的差不多。
  - 如果你设为 2.0：粒子很小，但皮很厚，水流看起来会融合在一起，很平滑。
  - **如果你设为 0.1 (你当前的设置！)：** 物理上算出了一个大水珠，但你让网格只显示中间那**十分之一**大小的核。

### 🚨 你的问题出在哪里？

请看你的截图数据：

- **Liquid 半径：** `1.000` (正常大小)
- **Mesh 半径：** **`0.100`** (极小！)

**这就是导致你网格破碎、闪烁、看起来像残渣的根本原因！**

**形象比喻：**

这就像是一个**大胖子（Liquid 1.0）**，你非要给他穿一件**婴儿的衣服（Mesh 0.1）**。

结果就是：衣服被撑爆了，或者是只能遮住胖子身体的一小部分，剩下的地方都露馅了（出现了空隙和断层）。

### ✅ 正确的配合策略

为了让水流看起来连续、光滑且有体积感，通常遵循以下原则：

1. **Mesh 半径 ≥ Liquid 半径**
   - Mesh 半径通常设为 **1.0 到 1.5** 之间（相对于 Liquid 半径的倍数，或者直接填数值）。
   - 目的是让水滴之间稍微有一点“重叠”，这样它们才能融合成一片完整的水面，而不是独立的小球。
2. **针对你的修正方案**
   - 保持 `Liquid > Particle Radius` 为 **1.000** 不变。
   - **修改 `Mesh > Particle Radius`：** 将那个 **0.100** 改回 **1.000**，或者尝试 **1.200**。

**操作步骤：**

1. 去 Mesh 面板，把 `Particle Radius` 改为 **1.2**。
2. 点击 **Free Mesh**。
3. 点击 **Bake Mesh**。

你会发现那些碎渣瞬间融合成了一条漂亮、饱满的水柱！



# 📝 Blender 流体模拟 (Mantaflow) 核心避坑笔记

这份笔记涵盖了我们讨论的所有核心痛点、误区纠正以及针对你易拉罐广告项目的实战参数。你可以直接保存。

------

### 1. 核心世界观：一切都是“积木” (Voxels)

Blender 的流体世界不是由光滑的模型组成的，而是由无数个小方块（体素/Voxel）堆出来的。

- **Resolution Divisions (分辨率):** 决定了积木块的大小。数值越高 = 积木越小 = 细节越多 = 越卡。
- **计算逻辑：** 系统会将流体域（Domain）的**最长边**切成 N 份。如果你的域是细长条，短边的精度会非常低（马赛克严重）。

### 2. 流程逻辑：先造骨，再贴皮

流体模拟分两步，必须按顺序来：

1. **Bake Data (烘焙数据):** 算出物理运动。生成蓝色的粒子（骨架）。
   - *Liquid 复选框：* 只是决定要不要在屏幕上**看**这些蓝点，不影响计算。
2. **Bake Mesh (烘焙网格):** 根据粒子生成实体模型（皮肤）。
   - *Mesh 复选框：* 决定是否生成最终能渲染的水面。

------

### 3. 致命误区：单位的“谎言” ⚠️

以下参数的单位**不是米 (Meters)**，而是**格子数 (Voxels)**！

*(这意味着：分辨率变了，这些参数的物理厚度也会自动跟着变)*

- **Surface Emission (表面发射):**
  - **作用：** 水流初始产生的厚度。
  - **错误值：** `1.0` (代表向外扩 1 个格子厚，微距下会变成巨大的水坨)。
  - **推荐值：** **`0`** (紧贴模型) 或 **`0.5`**。
- **Particle Radius (Liquid 面板):**
  - **作用：** 物理碰撞体积。
  - **推荐值：** **`1.0`** (死守这个值，别动)。
- **Particle Radius (Mesh 面板):**
  - **作用：** 生成皮肤的厚度。
  - **推荐值：** **`1.2` ~ `1.5`** (必须比 Liquid 半径大，否则水会碎成渣)。

------

### 4. 关键参数速查表 (人话版)

#### **A. 域 (Domain) 设置**

| **参数**              | **推荐值**    | **说明**                                      |
| --------------------- | ------------- | --------------------------------------------- |
| **Resolution**        | **64 ~ 128**  | 调试用 64，出图用 128+。域越小，精度越高。    |
| **Time Scale**        | **0.3 ~ 0.5** | **必改！** 慢动作能让水流更有高级感、重力感。 |
| **CFL Number**        | **2 ~ 4**     | 防穿模限速。水炸了/飞了就改小。               |
| **Border Collisions** | 按需勾选      | 想要水不流出框外，就勾上 Bottom 等。          |

#### **B. 液体 (Liquid) 设置**

| **参数**       | **推荐值** | **说明**                                 |
| -------------- | ---------- | ---------------------------------------- |
| **Sim Method** | **FLIP**   | 默认值。适合飞溅、冲击效果。             |
| **FLIP Ratio** | **0.97**   | 越低越像油（平滑），越高越像水（飞溅）。 |
| **System Max** | **0**      | 粒子总数上限，**别动**，否则水流会断。   |

#### **C. 发射器 (Flow) 设置**

| **参数**             | **推荐值**       | **说明**                                               |
| -------------------- | ---------------- | ------------------------------------------------------ |
| **Flow Behavior**    | **Inflow**       | **必选！** 像水龙头一样源源不断。Geometry 是一次性的。 |
| **Surface Emission** | **0**            | 紧贴发射器生成，防止第一帧出现“大水怪”。               |
| **Initial Velocity** | **Normal / XYZ** | 给水一个初速度。注意坐标轴方向。                       |

------

### 5. 常见故障排除 (Troubleshooting)

- **Q: 水看起来像一堆碎渣渣/闪烁？**
  - **A:** 你的 `Mesh > Particle Radius` 太小了（比如 0.1）。改成 **1.2**，把粒子粘起来。
- **Q: 水流方向反了 (设置 -10 反而往正向跑)？**
  - **A:** 发射器坐标轴乱了。选中发射器，**Ctrl + A** -> **Apply Rotation** (应用旋转)。
- **Q: 第一帧出现一个巨大的锯齿状水块？**
  - **A:** `Surface Emission` 设太大了（比如 10）。改成 **0**。
- **Q: 烘焙巨慢无比？**
  - **A:** 可能是你把域缩得很小，但分辨率没降。域体积变小后，可以适当降低 Resolution 数值。
- **Q: 粒子太少，水流太细？**
  - **A:** 提高 Domain 分辨率，或者把发射器模型做大一点（用看不见的粗圆柱体代替薄片发射）。

### 6. 易拉罐广告实战建议流程 🚀

1. **建替身：** 新建一个圆柱体作为发射器，隐藏渲染（不要用那个薄片）。
2. **设类型：** 发射器设为 **Inflow** (流入)，**Surface Emission** 设为 **0**。
3. **定时间：** Domain 的 **Time Scale** 设为 **0.4** (慢动作)。
4. **调半径：**
   - Liquid 半径: **1.0**
   - Mesh 半径: **1.2 ~ 1.4**
5. **归正坐标：** 确保发射器应用了旋转 (Ctrl+A)。
6. **先烘 Data，再烘 Mesh。**

#  blender 5.0 的 流体模拟中，缓存类型是模块，这种类型在释放缓存后重新烘焙后，也是有严重的不起作用的现象，应该如何根治？

Blender 的流体模拟（Mantaflow）缓存系统，尤其是**Modular（模块）**模式，确实存在“幽灵缓存”或无法正确刷新的老毛病。即使到了新版本（如 Blender 4.x/5.0 Alpha），由于底层机制未变，这个问题依然存在。

当你点击“释放（Free）”后重新烘焙，由于缓存文件（OpenVDB）可能被占用、未完全删除或软件内部状态未更新，导致你看到的一直是旧的流体效果。

想要“根治”这个问题，不能只依赖“释放”按钮。以下是几种由浅入深、绝对有效的解决方案：

------

### 方法一：修改“分辨率”数值（最快、最有效的“软”根治）

这是最有经验的 Blender 用户常用的“强制刷新”手段。Blender 内部逻辑是：如果分辨率变了，旧缓存就绝对无效，必须重新计算。

1. 找到 **Settings (设置)** -> **Resolution Divisions (分辨率)**。
2. 将数值**加 1 或 减 1**（例如从 64 改为 65）。
3. 再次点击 **Bake Data (烘焙数据)**。

> **原理：** 改变分辨率会强制重置整个模拟网格的体素大小，迫使 Mantaflow 彻底丢弃内存和硬盘中的所有旧数据。烘焙完成后，你可以改回原数值再烘焙一次（如果你有强迫症的话），但通常直接用新数值即可。

------

### 方法二：手动更名/清理缓存文件夹（物理“硬”根治）

如果软件内的“释放”按钮失灵，我们就直接在硬盘层面切断联系。这是最彻底的方法。

1. **保存你的工程文件（必须先保存）。**
2. 在缓存设置面板中（如图所示），找到最上方的路径框 `//cache_fluid_...`。
3. **直接修改路径名称**。例如在末尾加个数字：`//cache_fluid_4b85f272_v2`。
4. 重新点击烘焙。

或者：

1. 打开你的操作系统文件管理器。
2. 进入你的 .blend 文件旁边的 `cache_fluid...` 文件夹。
3. **手动删除**里面的所有文件夹（data, mesh, particles 等）。
4. 回到 Blender 重新烘焙。

------

### 方法三：理解并正确操作“模块（Modular）”流程

“模块”类型的核心逻辑是**分层烘焙**。很多时候“不起作用”是因为你只释放了基础数据，却忘记了后面依赖它的层级。

**正确的重烘焙顺序（必须严格遵守）：**

1. **Free Mesh (释放网格)**：必须先释放网格！因为网格是基于 Data 生成的。如果 Data 变了但 Mesh 缓存还在，你会看到旧的形状。
2. **Free Data (释放数据)**：接着释放基础物理数据。
3. **Bake Data (烘焙数据)**：重新计算物理。
4. **Bake Mesh (烘焙网格)**：重新生成皮。

> **常见误区：** 很多人只点了 Free Data 然后重新 Bake Data，结果视口里开着“Mesh”显示，看到的还是旧的网格壳子，以为模拟没变，其实是因为网格没更新。

------

### 方法四：检查 "Is Resumable"（可恢复）选项

在你的截图下方（或设置面板中），通常有一个 **Is Resumable (可恢复)** 的复选框。

- **建议：** 在测试阶段，**不要勾选**这个选项。
- **原因：** “可恢复”模式会试图保留每一帧的状态以便接着算。当你想要彻底推倒重来时，这个功能往往会干扰缓存的彻底清理，导致新旧数据冲突。只有当你确定最终要进行超长时间烘焙且怕崩溃时，再勾选它。

------

### 方法五：核弹级复位（针对极度顽固的情况）

如果上述方法都无效，说明该 Domain（域）对象的内部 ID 可能出问题了：

1. 选中你的 **Domain (流体域)** 物体。
2. 按 `Shift + D` 复制一个放在原位。
3. 删除原来的那个旧 Domain。
4. 在新的 Domain 上重新烘焙。

------

### 总结建议

为了避免反复遇到这个问题，建议养成以下工作流习惯：

1. **先保存文件**：确保路径 `//` 能被正确解析。
2. **改名大法**：每次做重大参数修改想重算时，**修改一下缓存文件夹的后缀名**（如 `cache_v1`, `cache_v2`）。这不仅能根治不刷新的问题，还能让你保留不同版本的模拟结果进行对比。

**你现在想试一下“修改分辨率 +1”这个方法吗？这通常能立刻解决问题。**

##  方法一：修改“分辨率”数值（最快、最有效的“软”根治）:这个最有效，是100%有效？

可以说，针对**“强迫软件重新计算物理数据”**这一点，它是 **100% 有效**的。

在 Blender 社区和开发逻辑中，这被公认为解决缓存死锁的“必杀技”。

为什么敢说是 100%？因为这涉及到底层的**数据结构逻辑**：

### 1. 它是底层逻辑的“掀桌子”行为

当你点击普通的“释放（Free）”时，Blender 只是尝试删除或解绑文件。如果文件被系统占用（或者有 Bug），这个操作就会失败，导致你重新烘焙时，它又偷偷读回了旧文件。

但是，当你修改**分辨率（Resolution Divisions）**（比如从 64 改为 65）时：

- **体素网格（Voxel Grid）**的物理尺寸发生了改变。
- 旧的缓存数据（基于 64 分辨率的网格）在数学上**完全无法匹配**新的网格（65 分辨率）。
- Blender **被迫**承认旧数据无效，必须从零开始计算每一个粒子的位置。它根本无法“偷懒”去读旧缓存，因为读进来也是错的。

------

### 唯一可能让你觉得“失效”的 2 种视觉误区

虽然**物理计算**是 100% 更新了，但在**视觉反馈**上，你可能会遇到以下两个“坑”，让你误以为它没生效：

#### 误区一：只烘焙了 Data，却看着旧的 Mesh

这是最常见的情况。

- **现象**：你改了分辨率，重新烘焙了 Data（粒子/物理），进度条也走了。但视口里的流体形状完全没变。
- **原因**：你可能开启了 **Mesh（网格）** 选项。流体模拟分两层：里层是 Data（物理），外皮是 Mesh。你更新了里层的物理，但外面的皮（Mesh 缓存）还是旧的。
- **解决**：确保在烘焙 Data 之后，必须点击 **Free Mesh** 并重新 **Bake Mesh**。

#### 误区二：当前帧未刷新

- **现象**：烘焙完了，画面还是旧的。
- **原因**：显存里卡着上一帧的图像。
- **解决**：在时间轴上**随便拖动一下**，或者按一下键盘的左/右箭头键（切换帧），画面就会立刻跳变为新的结果。

### 结论

只要你改了分辨率数值，**物理模拟就一定会重新算**。如果改了数值看起来还不对，那一定不是“缓存没刷新”，而是你的**模拟参数本身设错了**（比如流体源没开、碰撞体失效等）。

**您可以放心用这个方法，改数值是目前除“删文件夹”外最霸道的手段。**